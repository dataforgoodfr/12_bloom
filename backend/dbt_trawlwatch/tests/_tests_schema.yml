version: 2
data_tests:
  - name: assert_first_and_last_position_complete
    description: >
      This test checks that the number of vessels in the first and last positions table matches the number of distinct vessel_id in the dimension table.
  - name: assert_last_raw_position_complete
    description: >
      This test checks that the number of vessels in the last raw position table matches the number of distinct vessel_id in the dimension table.
  - name: assert_port_w_excursions_have_positive_time_total_port_call
    description: >
      This test checks that each port with excursions has at least one port_call associated with it.
  - name: assert_port_w_excursions_have_positive_time_total_port_call
    description: >
      This test checks that each port with excursions has a positive total time of port calls.
  - name: assert_no_more_than_1_open_ongoing_excursion_per_vessel
    description: >
      This test checks that there is no more than one open/ongoing excursion per vessel.
  - name: assert_excursion_duration_is_positive_if_not_ongoing
    description: >
      This test checks that the excursion duration is positive if the excursion is not ongoing.